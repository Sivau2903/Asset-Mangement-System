@model IEnumerable<WebApplication5.Models.MaterialMasterList>

@{
    Layout = "~/Views/Shared/_StoreAdminLayout.cshtml";
    ViewBag.Title = "Material Master List";
}

<div class="container mt-4">
    <h2 class="mb-4 fw-bold text-primary">Material Master List</h2>

    <!-- Search filter -->
    <input type="text" id="searchBox" class="form-control mb-3" placeholder="Search materials..." style="width:20%" />

    <div style="max-height: 500px; overflow-y: auto; border: 1px solid #ddd; border-radius: 6px; padding: 10px;">
        <table class="table table-bordered table-striped text-center align-middle">
            <thead class="table-primary">
                <tr>
                    <th>Asset Type</th>
                    <th>Category</th>
                    <th>Sub Category</th>
                    <th>Available Quantity</th>
                    <th>Units</th>
                    <th>Minimum Limit</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="materialsTable">
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.AssetType</td>
                        <td>@item.MaterialCategory</td>
                        <td>@item.MaterialSubCategory</td>
                        <td>@item.AvailableQuantity</td>
                        <td>@item.Units</td>
                        <td>
                            @using (Html.BeginForm("MaterialMasterForm", "Home", FormMethod.Post))
                            {
                                @Html.AntiForgeryToken()
                                @Html.HiddenFor(m => item.MasterListID)

                                <input type="number" name="MinimumLimit" value="@item.MinimumLimit" class="form-control text-center" style="width:100px;" />

                                <input type="hidden" name="AssetType" value="@item.AssetType" />
                                <input type="hidden" name="MaterialCategory" value="@item.MaterialCategory" />
                                <input type="hidden" name="MaterialSubCategory" value="@item.MaterialSubCategory" />
                                <input type="hidden" name="AvailableQuantity" value="@item.AvailableQuantity" />
                                <input type="hidden" name="Units" value="@item.Units" />
                                <input type="hidden" name="UniversityID" value="@item.UniversityID" />

                               
                            }
                        </td>
                        <td> <button type="submit" class="btn btn-sm btn-success mt-1">Save</button></td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success mt-3">@TempData["SuccessMessage"]</div>
    }
</div>

<script>
    // Filter rows in the table
    document.getElementById("searchBox").addEventListener("keyup", function () {
        var filter = this.value.toLowerCase();
        var rows = document.querySelectorAll("#materialsTable tr");

        rows.forEach(row => {
            var text = row.innerText.toLowerCase();
            row.style.display = text.includes(filter) ? "" : "none";
        });
    });
</script>
